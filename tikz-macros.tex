\usetikzlibrary{decorations.pathmorphing} % for snake, zigzag...
\usetikzlibrary{decorations.pathreplacing} % for braces
\usetikzlibrary{fit} % for fit=(A) (B) (C)...
\usetikzlibrary{positioning} % for the "below of=1cm" type of options
\usetikzlibrary{intersections} % e.g. for pyramid
\usetikzlibrary{calc} % for computing node coordinates from others
\usetikzlibrary{math} % for pgf math stuff
\usetikzlibrary{overlay-beamer-styles} % when \pause glitches in tikz beamer
\usetikzlibrary{arrows} % arrows
\usetikzlibrary{external} % only compile the figure the first time
\tikzexternalize[only named=true, prefix=tikz-cache/]
\immediate\write18{mkdir -p latex-build/tikz-cache}

% used to pass "scale=XX" as includetikz option
\pgfkeys{
  /tikzoptions/.is family, % Namespace
  /tikzoptions/.cd, % Namespace
  scale/.store in=\scale, % Store the value of 'scale'
}

% oplus node, usage \node[oplus=1cm] or any radius value
\tikzset{
  oplus/.style={
    circle, draw,
    minimum size=2*#1, % diameter = 2 * radius
    inner sep=0pt,
    transform shape=true,
    append after command={
      % Draw vertical line
      \pgfextra{
        \def\r{#1}
        % Draw vertical line
        \draw ($(\tikzlastnode) + (0,-\r)$) --
        ($(\tikzlastnode) + (0,\r)$);
        % Draw horizontal line
        \draw ($(\tikzlastnode) + (-\r,0)$) --
        ($(\tikzlastnode) + (\r,0)$);
      }
    },
  }
}

% usage: \includetikz[scale=XX]{fig}, fetches from my local database
\newcommand{\includetikz}[2][scale=1]{
  \bgroup
  \pgfkeys{/tikzoptions,#1} % currently only accepts 'scale' (april 9 2025)
  \tikzsetnextfilename{#2}
  \include{tex-macros/tikz-figures/#2}% Include the standalone TikZ file
  \egroup
}

% usage: \inputtikz[scale=XX]{fig}, fetches from my local database
\newcommand{\inputtikz}[2][scale=1]{
  \bgroup
  \pgfkeys{/tikzoptions,#1} % currently only accepts 'scale' (april 9 2025)
  \tikzsetnextfilename{#2}
  \input{tex-macros/tikz-figures/#2}% Include the standalone TikZ file
  \egroup
}
